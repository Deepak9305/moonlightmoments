<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moonlight Moments | Pure Celestial Archive</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✨</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,700;1,700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #050505; --text-color: #E0E0E0; --accent: #72a4f2;
            --glass: rgba(255, 255, 255, 0.05); --glass-border: rgba(255, 255, 255, 0.1);
            --transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: var(--bg-color); color: var(--text-color); font-family: 'Inter', sans-serif; overflow-x: hidden; line-height: 1.6; }

        /* Custom Cursor */
        #cursor-ring { 
            width: 24px; height: 24px; border: 2px solid #fff; border-radius: 50%; 
            position: fixed; pointer-events: none; z-index: 100000; mix-blend-mode: difference; 
            display: none; top: 0; left: 0; transition: width 0.3s, height 0.3s, background 0.3s;
        }
        .cursor-expand { width: 50px !important; height: 50px !important; background: rgba(255,255,255,0.1); }
        .no-mouse { cursor: none !important; }

        /* Navigation */
        .glass-nav { position: fixed; top: 0; width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 1.2rem 5%; background: rgba(5, 5, 5, 0.85); backdrop-filter: blur(25px); border-bottom: 1px solid var(--glass-border); z-index: 1000; }
        .logo { font-family: 'Playfair Display'; font-size: 1.4rem; font-weight: 700; text-decoration: none; color: white; }
        .nav-right { display: flex; gap: 15px; align-items: center; }
        .support-btn { color: var(--accent); text-decoration: none; font-size: 0.85rem; border: 1px solid var(--accent); padding: 8px 18px; border-radius: 20px; transition: 0.3s; font-weight: 600; }
        .support-btn:hover { background: var(--accent); color: white; }

        .hamburger-btn { background: var(--glass); border: none; width: 40px; height: 40px; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 4px; cursor: pointer; }
        .hamburger-btn span { width: 18px; height: 2px; background: white; transition: 0.3s; }
        
        .dropdown { position: relative; }
        .dropdown-content { display: none; position: absolute; right: 0; top: 50px; background: #0f0f0f; min-width: 200px; border: 1px solid var(--glass-border); border-radius: 12px; overflow: hidden; }
        .dropdown-content.show { display: block; }
        .dropdown-content a { color: #ccc; padding: 14px 20px; text-decoration: none; display: block; font-size: 0.85rem; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .dropdown-content a:hover { background: var(--accent); color: white; }

        /* Hero */
        .hero-section { min-height: 100vh; display: flex; align-items: center; justify-content: center; position: relative; text-align: center; padding: 140px 20px 40px; }
        #hero-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.4; background: #000; }
        #hero-bg img { width: 100%; height: 100%; object-fit: cover; transition: 2s; }
        
        .hero-controls { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 15px; margin: 0 auto; }
        .input-pill { background: var(--glass); border: 1px solid var(--glass-border); padding: 6px; border-radius: 40px; display: flex; backdrop-filter: blur(10px); }
        .input-pill input { background: none; border: none; padding: 10px 20px; color: white; flex: 1; outline: none; font-size: 0.9rem; }
        .btn-pill { background: var(--accent); color: white; border: none; padding: 10px 25px; border-radius: 30px; font-weight: 600; cursor: pointer; transition: 0.3s; }

        /* Gallery */
        .gallery-section { padding: 80px 8%; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .grid-item-card { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 16px; overflow: hidden; opacity: 0; transform: translateY(30px); transition: 0.5s; cursor: pointer; }
        .card-img-wrapper { aspect-ratio: 16/10; overflow: hidden; background: #111; }
        .card-img-wrapper img { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: 1.2s; }

        /* Footer */
        footer { padding: 100px 5% 40px; text-align: center; border-top: 1px solid var(--glass-border); }
        .support-us-footer { max-width: 700px; margin: 0 auto 60px; background: var(--glass); border: 1px solid var(--glass-border); padding: 40px 20px; border-radius: 24px; }
        .footer-nav { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 40px; }
        .footer-btn { color: #aaa; text-decoration: none; font-size: 0.75rem; padding: 10px 22px; border: 1px solid var(--glass-border); border-radius: 30px; background: var(--glass); }

        /* Modals & Zoom */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; z-index: 2000; justify-content: center; align-items: center; padding: 20px; backdrop-filter: blur(20px); }
        .modal-content { background: #0a0a0a; width: 100%; max-width: 1100px; display: flex; border: 1px solid var(--glass-border); position: relative; max-height: 90vh; border-radius: 12px; overflow: hidden; }
        
        .modal-img-side { flex: 1.5; background: #000; position: relative; overflow: hidden; cursor: zoom-in; display: flex; align-items: center; justify-content: center; }
        .modal-img-side img { width: 100%; height: 100%; object-fit: contain; transition: transform 0.3s ease-out; transform-origin: center center; }
        .modal-img-side.zoomed { cursor: zoom-out; }
        .modal-img-side.zoomed img { transform: scale(2.5); }

        .modal-text-side { flex: 1; padding: 40px; overflow-y: auto; background: #0a0a0a; border-left: 1px solid var(--glass-border); }

        #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #050505; z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s; }
        .loader-spin { width: 40px; height: 40px; border: 2px solid rgba(114, 164, 242, 0.1); border-top: 2px solid var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }

        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 768px) { .modal-content { flex-direction: column; } .modal-img-side { height: 300px; flex: none; } }
    </style>
</head>
<body class="no-mouse">

    <div id="preloader"><div class="loader-spin"></div><p style="margin-top:15px; font-size:0.6rem; letter-spacing:2px;">PURIFYING COSMIC DATA</p></div>
    <div id="cursor-ring"></div>

    <nav class="glass-nav">
        <a href="index.html" class="logo">moonlightmoments.co.in</a>
        <div class="nav-right">
            <a href="https://ko-fi.com/moonlightmoments" target="_blank" class="support-btn">Support Us</a>
            <div class="dropdown">
                <button class="hamburger-btn" id="menuBtn"><span></span><span></span><span></span></button>
                <div class="dropdown-content" id="myDropdown">
                    <a href="index.html">✦ Archive</a>
                    <a href="age.html">✦ Identity</a>
                    <a href="event.html">✦ Forecast</a>
                    <hr style="border:0; border-top:1px solid #222; margin:5px 0;">
                    <a href="javascript:void(0)" onclick="showLegal('about')">Our Story</a>
                    <a href="javascript:void(0)" onclick="showLegal('privacy')">Privacy Orbit</a>
                </div>
            </div>
        </div>
    </nav>

    <header class="hero-section">
        <div id="hero-bg"></div>
        <div class="hero-content">
            <h1 style="font-family:'Playfair Display'; font-size:clamp(2.2rem, 8vw, 4.5rem); margin-bottom:30px;">Moonlight Moments</h1>
            <div class="hero-controls">
                <div class="input-pill">
                    <input type="text" id="search-input" placeholder="Search cosmic bodies...">
                    <button class="btn-pill" id="search-btn">Explore</button>
                </div>
                <div class="input-pill" style="max-width:350px; margin:0 auto;">
                    <input type="date" id="date-input">
                    <button class="btn-pill" id="date-btn">Birth Star</button>
                </div>
            </div>
        </div>
    </header>

    <section class="gallery-section">
        <div class="grid-container" id="main-grid"></div>
        <div style="text-align:center; margin-top:50px;">
            <button class="btn-pill" onclick="loadLibraryGallery()" style="background:none; border:1px solid var(--accent); color:var(--accent);">↻ Re-Sync Natural Archive</button>
        </div>
    </section>

    <footer>
        <div class="support-us-footer">
            <h2 style="font-family:'Playfair Display'; font-style:italic; margin-bottom:15px;">A Sanctuary in the Stars</h2>
            <p style="font-size:0.9rem; color:#aaa; margin-bottom:25px;">Filtering thousands of NASA records to ensure a purely celestial experience.</p>
            <a href="https://ko-fi.com/moonlightmoments" target="_blank" class="support-btn" style="padding:12px 30px;">☕ Support on Ko-fi</a>
        </div>
        <p style="color:#444; font-size:0.65rem; letter-spacing:2px;">&copy; 2026 MOONLIGHT MOMENTS | NASA OPEN ARCHIVE</p>
    </footer>

    <div id="modal" class="modal-overlay">
        <div class="modal-content">
            <button style="position:absolute; top:15px; right:20px; color:white; font-size:2rem; background:none; border:none; cursor:pointer; z-index:10;" onclick="closeModal()">&times;</button>
            <div class="modal-img-side" id="zoom-container">
                <img id="m-img" src="">
            </div>
            <div class="modal-text-side">
                <span id="m-date" style="color:var(--accent); font-size:0.75rem;"></span>
                <h2 id="m-title" style="font-family:'Playfair Display'; margin:10px 0;"></h2>
                <p id="m-desc" style="color:#999; font-size:0.85rem; margin-bottom:30px;"></p>
                <button id="m-dl" style="width:100%; padding:15px; background:white; color:black; border:none; font-weight:700; border-radius:8px; cursor:pointer;">DOWNLOAD</button>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = 'DzuEQHQeW71HYPPMwkW66E0B8dYiVEVPRdLkfaRk';
        let galleryItems = [];

        // Strict Artificial/Terrestrial Blacklist
        const blacklist = [
            'person', 'people', 'engineer', 'technician', 'astronaut', 'suit', 'portrait', 'standing', 'working',
            'office', 'building', 'facility', 'clean room', 'lab', 'desk', 'computer', 'monitor', 'interior',
            'antenna', 'telescope structure', 'machinery', 'payload', 'hardware', 'component', 'module', 'frame',
            'satellite', 'spacecraft', 'probe', 'rover', 'orbiter', 'lander', 'shuttle', 'station', 'iss', 
            'telescope design', 'vessel', 'rocket', 'launch', 'fairing', 'array', 'solar panel',
            'hubble assembly', 'webb mirror', 'curiosity', 'perseverance', 'voyager', 'cassini', 'juno',
            'logo', 'text', 'diagram', 'chart', 'graph', 'blueprint', 'map'
        ];

        // --- Cursor ---
        const cursor = document.getElementById('cursor-ring');
        let mouseX = 0, mouseY = 0, ringX = 0, ringY = 0;
        document.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; if(window.innerWidth > 768) cursor.style.display = 'block'; });
        function animateCursor() { ringX += (mouseX - ringX)*0.15; ringY += (mouseY - ringY)*0.15; cursor.style.transform = `translate3d(${ringX-12}px, ${ringY-12}px, 0)`; requestAnimationFrame(animateCursor); }
        animateCursor();

        // --- Gallery Engine ---
        async function loadLibraryGallery(query = '') {
            const preloader = document.getElementById('preloader');
            preloader.style.display = 'flex'; preloader.style.opacity = '1';
            
            // Search query remains open to user intent
            const cosmicPool = ['nebula', 'galaxy', 'supernova', 'star cluster', 'deep space'];
            const q = query || cosmicPool[Math.floor(Math.random()*cosmicPool.length)];

            try {
                const res = await fetch(`https://images-api.nasa.gov/search?q=${q}&media_type=image`);
                const d = await res.json();
                
                // Filtering Logic: Scan all metadata for blacklist terms
                const filtered = d.collection.items.filter(item => {
                    const data = item.data[0];
                    const meta = (data.title + " " + (data.description || "") + " " + (data.keywords ? data.keywords.join(" ") : "")).toLowerCase();
                    return !blacklist.some(word => meta.includes(word));
                });

                galleryItems = filtered.sort(() => 0.5 - Math.random()).slice(0, 16).map(i => ({
                    url: i.links[0].href, title: i.data[0].title, explanation: i.data[0].description, date: i.data[0].date_created.split('T')[0]
                }));
                
                renderGrid();
                if(galleryItems[0]) document.getElementById('hero-bg').innerHTML = `<img src="${galleryItems[0].url}">`;
            } catch(e) { console.error(e); }
            finally { setTimeout(() => { preloader.style.opacity = '0'; setTimeout(() => preloader.style.display = 'none', 800); }, 500); }
        }

        function renderGrid() {
            document.getElementById('main-grid').innerHTML = galleryItems.map((item, i) => `
                <div class="grid-item-card" onclick="openModal(${i})" style="animation: fadeInUp 0.6s forwards ${i*0.1}s;">
                    <div class="card-img-wrapper"><img src="${item.url}" onload="this.style.opacity='1'"></div>
                    <div style="padding:20px;">
                        <span style="font-size:0.7rem; color:var(--accent);">${item.date}</span>
                        <h3 style="font-size:0.95rem; margin-top:5px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${item.title}</h3>
                    </div>
                </div>`).join('');
            setupHovers();
        }

        function setupHovers() {
            document.querySelectorAll('a, button, .grid-item-card, input').forEach(el => {
                el.onmouseenter = () => cursor.classList.add('cursor-expand');
                el.onmouseleave = () => cursor.classList.remove('cursor-expand');
            });
        }

        // --- Zoom & Pan ---
        const zoomContainer = document.getElementById('zoom-container');
        const zoomImg = document.getElementById('m-img');

        zoomContainer.addEventListener('click', () => {
            zoomContainer.classList.toggle('zoomed');
            if(!zoomContainer.classList.contains('zoomed')) zoomImg.style.transform = `scale(1) translate(0,0)`;
        });

        zoomContainer.addEventListener('mousemove', (e) => {
            if (!zoomContainer.classList.contains('zoomed')) return;
            const rect = zoomContainer.getBoundingClientRect();
            const x = (e.clientX - rect.left) / rect.width;
            const y = (e.clientY - rect.top) / rect.height;
            zoomImg.style.transform = `scale(2.5) translate(${(0.5 - x) * 100}%, ${(0.5 - y) * 100}%)`;
        });

        function openModal(i) {
            const item = galleryItems[i];
            zoomImg.src = item.url;
            zoomContainer.classList.remove('zoomed');
            zoomImg.style.transform = `scale(1) translate(0,0)`;
            document.getElementById('m-title').innerText = item.title;
            document.getElementById('m-date').innerText = item.date;
            document.getElementById('m-desc').innerText = item.explanation;
            document.getElementById('modal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
            document.getElementById('m-dl').onclick = () => window.open(item.url, '_blank');
        }

        function closeModal() { document.getElementById('modal').style.display='none'; document.body.style.overflow='auto'; }

        document.getElementById('search-btn').onclick = () => { const v = document.getElementById('search-input').value; if(v) loadLibraryGallery(v); };
        
        document.getElementById('date-btn').onclick = async function() {
            const date = document.getElementById('date-input').value;
            if(!date) return;
            this.innerText = "...";
            try {
                const res = await fetch(`https://api.nasa.gov/planetary/apod?date=${date}&api_key=${API_KEY}`);
                const item = await res.json();
                galleryItems.unshift({ url: item.url, title: item.title, explanation: item.explanation, date: item.date });
                renderGrid(); openModal(0);
            } catch(e) { alert("Data unavailable."); }
            finally { this.innerText = "Birth Star"; }
        };

        document.getElementById('menuBtn').onclick = (e) => { e.stopPropagation(); document.getElementById('myDropdown').classList.toggle('show'); };
        window.onclick = () => document.getElementById('myDropdown').classList.remove('show');

        loadLibraryGallery();
    </script>
</body>
</html>
